!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).jarallax=t()}(this,function(){"use strict";function e(e){"complete"===document.readyState||"interactive"===document.readyState?e():document.addEventListener("DOMContentLoaded",e,{capture:!0,once:!0,passive:!0})}let t;var g=t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};const r=g["navigator"],i=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(r.userAgent);let o;let u;function n(){u=i?(!o&&document.body&&((o=document.createElement("div")).style.cssText="position: fixed; top: -9999px; left: 0; height: 100vh; width: 0;",document.body.appendChild(o)),(o?o.clientHeight:0)||g.innerHeight||document.documentElement.clientHeight):g.innerHeight||document.documentElement.clientHeight}n(),g.addEventListener("resize",n),g.addEventListener("orientationchange",n),g.addEventListener("load",n),e(()=>{n()});const s=[];function a(){s.length&&(s.forEach((e,t)=>{const{instance:i,oldData:o}=e;var e=i.$item.getBoundingClientRect(),e={width:e.width,height:e.height,top:e.top,bottom:e.bottom,wndW:g.innerWidth,wndH:u},n=!o||o.wndW!==e.wndW||o.wndH!==e.wndH||o.width!==e.width||o.height!==e.height,a=n||!o||o.top!==e.top||o.bottom!==e.bottom;s[t].oldData=e,n&&i.onResize(),a&&i.onScroll()}),g.requestAnimationFrame(a))}let m=0;class l{constructor(e,t){const i=this,o=(i.instanceID=m,m+=1,i.$item=e,i.defaults={type:"scroll",speed:.5,imgSrc:null,imgElement:".jarallax-img",imgSize:"cover",imgPosition:"50% 50%",imgRepeat:"no-repeat",keepImg:!1,elementInViewport:null,zIndex:-100,disableParallax:!1,disableVideo:!1,videoSrc:null,videoStartTime:0,videoEndTime:0,videoVolume:0,videoLoop:!0,videoPlayOnlyVisible:!0,videoLazyLoading:!0,onScroll:null,onInit:null,onDestroy:null,onCoverImage:null},i.$item.dataset||{}),n={};if(Object.keys(o).forEach(e=>{var t=e.substr(0,1).toLowerCase()+e.substr(1);t&&void 0!==i.defaults[t]&&(n[t]=o[e])}),i.options=i.extend({},i.defaults,n,t),i.pureOptions=i.extend({},i.options),Object.keys(i.options).forEach(e=>{"true"===i.options[e]?i.options[e]=!0:"false"===i.options[e]&&(i.options[e]=!1)}),i.options.speed=Math.min(2,Math.max(-1,parseFloat(i.options.speed))),"string"==typeof i.options.disableParallax&&(i.options.disableParallax=new RegExp(i.options.disableParallax)),i.options.disableParallax instanceof RegExp){const s=i.options.disableParallax;i.options.disableParallax=()=>s.test(r.userAgent)}if("function"!=typeof i.options.disableParallax&&(i.options.disableParallax=()=>!1),"string"==typeof i.options.disableVideo&&(i.options.disableVideo=new RegExp(i.options.disableVideo)),i.options.disableVideo instanceof RegExp){const l=i.options.disableVideo;i.options.disableVideo=()=>l.test(r.userAgent)}"function"!=typeof i.options.disableVideo&&(i.options.disableVideo=()=>!1);let a=i.options.elementInViewport;a&&"object"==typeof a&&void 0!==a.length&&([a]=a),a instanceof Element||(a=null),i.options.elementInViewport=a,i.image={src:i.options.imgSrc||null,$container:null,useImgTag:!1,position:"fixed"},i.initImg()&&i.canInitParallax()&&i.init()}css(t,i){return"string"==typeof i?g.getComputedStyle(t).getPropertyValue(i):(Object.keys(i).forEach(e=>{t.style[e]=i[e]}),t)}extend(i,...o){return i=i||{},Object.keys(o).forEach(t=>{o[t]&&Object.keys(o[t]).forEach(e=>{i[e]=o[t][e]})}),i}getWindowData(){return{width:g.innerWidth||document.documentElement.clientWidth,height:u,y:document.documentElement.scrollTop}}initImg(){var e=this;let t=e.options.imgElement;return(t=t&&"string"==typeof t?e.$item.querySelector(t):t)instanceof Element||(e.options.imgSrc?(t=new Image).src=e.options.imgSrc:t=null),t&&(e.options.keepImg?e.image.$item=t.cloneNode(!0):(e.image.$item=t,e.image.$itemParent=t.parentNode),e.image.useImgTag=!0),!!e.image.$item||(null===e.image.src&&(e.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.image.bgImage=e.css(e.$item,"background-image")),!(!e.image.bgImage||"none"===e.image.bgImage))}canInitParallax(){return!this.options.disableParallax()}init(){var e,t=this,i={position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"};let o={pointerEvents:"none",transformStyle:"preserve-3d",backfaceVisibility:"hidden",willChange:"transform,opacity"};t.options.keepImg||((e=t.$item.getAttribute("style"))&&t.$item.setAttribute("data-jarallax-original-styles",e),t.image.useImgTag&&(e=t.image.$item.getAttribute("style"))&&t.image.$item.setAttribute("data-jarallax-original-styles",e)),"static"===t.css(t.$item,"position")&&t.css(t.$item,{position:"relative"}),"auto"===t.css(t.$item,"z-index")&&t.css(t.$item,{zIndex:0}),t.image.$container=document.createElement("div"),t.css(t.image.$container,i),t.css(t.image.$container,{"z-index":t.options.zIndex}),"fixed"===this.image.position&&t.css(t.image.$container,{"-webkit-clip-path":"polygon(0 0, 100% 0, 100% 100%, 0 100%)","clip-path":"polygon(0 0, 100% 0, 100% 100%, 0 100%)"}),t.image.$container.setAttribute("id","jarallax-container-"+t.instanceID),t.$item.appendChild(t.image.$container),t.image.useImgTag?o=t.extend({"object-fit":t.options.imgSize,"object-position":t.options.imgPosition,"max-width":"none"},i,o):(t.image.$item=document.createElement("div"),t.image.src&&(o=t.extend({"background-position":t.options.imgPosition,"background-size":t.options.imgSize,"background-repeat":t.options.imgRepeat,"background-image":t.image.bgImage||`url("${t.image.src}")`},i,o))),"opacity"!==t.options.type&&"scale"!==t.options.type&&"scale-opacity"!==t.options.type&&1!==t.options.speed||(t.image.position="absolute"),"fixed"===t.image.position&&(e=function(e){const t=[];for(;null!==e.parentElement;)1===(e=e.parentElement).nodeType&&t.push(e);return t}(t.$item).filter(e=>{var e=g.getComputedStyle(e),t=e["-webkit-transform"]||e["-moz-transform"]||e.transform;return t&&"none"!==t||/(auto|scroll)/.test(e.overflow+e["overflow-y"]+e["overflow-x"])}),t.image.position=e.length?"absolute":"fixed"),o.position=t.image.position,t.css(t.image.$item,o),t.image.$container.appendChild(t.image.$item),t.onResize(),t.onScroll(!0),t.options.onInit&&t.options.onInit.call(t),"none"!==t.css(t.$item,"background-image")&&t.css(t.$item,{"background-image":"none"}),t.addToParallaxList()}addToParallaxList(){s.push({instance:this}),1===s.length&&g.requestAnimationFrame(a)}removeFromParallaxList(){const i=this;s.forEach((e,t)=>{e.instance.instanceID===i.instanceID&&s.splice(t,1)})}destroy(){var e,t=this,i=(t.removeFromParallaxList(),t.$item.getAttribute("data-jarallax-original-styles"));t.$item.removeAttribute("data-jarallax-original-styles"),i?t.$item.setAttribute("style",i):t.$item.removeAttribute("style"),t.image.useImgTag&&(e=t.image.$item.getAttribute("data-jarallax-original-styles"),t.image.$item.removeAttribute("data-jarallax-original-styles"),e?t.image.$item.setAttribute("style",i):t.image.$item.removeAttribute("style"),t.image.$itemParent&&t.image.$itemParent.appendChild(t.image.$item)),t.image.$container&&t.image.$container.parentNode.removeChild(t.image.$container),t.options.onDestroy&&t.options.onDestroy.call(t),delete t.$item.jarallax}clipContainer(){}coverImage(){var e=this,t=e.image.$container.getBoundingClientRect(),i=t.height,o=e.options["speed"],n="scroll"===e.options.type||"scroll-opacity"===e.options.type;let a=0,s=i,l=0;return n&&(o<0?(a=o*Math.max(i,u),u<i&&(a-=o*(i-u))):a=o*(i+u),1<o?s=Math.abs(a-u):o<0?s=a/o+Math.abs(a):s+=(u-i)*(1-o),a/=2),e.parallaxScrollDistance=a,l=n?(u-s)/2:(i-s)/2,e.css(e.image.$item,{height:s+"px",marginTop:l+"px",left:"fixed"===e.image.position?t.left+"px":"0",width:t.width+"px"}),e.options.onCoverImage&&e.options.onCoverImage.call(e),{image:{height:s,marginTop:l},container:t}}isVisible(){return this.isElementInViewport||!1}onScroll(e){var i=this,o=i.$item.getBoundingClientRect(),n=o.top,a=o.height;const s={};let t=o;if(i.options.elementInViewport&&(t=i.options.elementInViewport.getBoundingClientRect()),i.isElementInViewport=0<=t.bottom&&0<=t.right&&t.top<=u&&t.left<=g.innerWidth,e||i.isElementInViewport){var e=Math.max(0,n),l=Math.max(0,a+n),r=Math.max(0,-n),m=Math.max(0,n+a-u),p=Math.max(0,a-(n+a-u)),c=Math.max(0,-n+u-a),d=1-(u-n)/(u+a)*2;let t=1;if(a<u?t=1-(r||m)/a:l<=u?t=l/u:p<=u&&(t=p/u),"opacity"!==i.options.type&&"scale-opacity"!==i.options.type&&"scroll-opacity"!==i.options.type||(s.transform="translate3d(0,0,0)",s.opacity=t),"scale"===i.options.type||"scale-opacity"===i.options.type){let e=1;i.options.speed<0?e-=i.options.speed*t:e+=i.options.speed*(1-t),s.transform=`scale(${e}) translate3d(0,0,0)`}if("scroll"===i.options.type||"scroll-opacity"===i.options.type){let e=i.parallaxScrollDistance*d;"absolute"===i.image.position&&(e-=n),s.transform=`translate3d(0,${e}px,0)`}i.css(i.image.$item,s),i.options.onScroll&&i.options.onScroll.call(i,{section:o,beforeTop:e,beforeTopEnd:l,afterTop:r,beforeBottom:m,beforeBottomEnd:p,afterBottom:c,visiblePercent:t,fromViewportCenter:d})}}onResize(){this.coverImage()}}function p(e,t,...i){var o=(e=("object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)?[e]:e).length;let n=0,a;for(n;n<o;n+=1)if("object"==typeof t||void 0===t?e[n].jarallax||(e[n].jarallax=new l(e[n],t)):e[n].jarallax&&(a=e[n].jarallax[t].apply(e[n].jarallax,i)),void 0!==a)return a;return e}p.constructor=l;const c=g.jQuery;if(void 0!==c){var d=function(...e){Array.prototype.unshift.call(e,this);e=p.apply(g,e);return"object"!=typeof e?e:this};d.constructor=p.constructor;const f=c.fn.jarallax;c.fn.jarallax=d,c.fn.jarallax.noConflict=function(){return c.fn.jarallax=f,this}}return e(()=>{p(document.querySelectorAll("[data-jarallax]"))}),p});